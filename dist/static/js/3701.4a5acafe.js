"use strict";(self["webpackChunksphere_dashboard"]=self["webpackChunksphere_dashboard"]||[]).push([[3701],{4502:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return CompanyInfo}});var _mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(62833);var _mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13087);var _mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(82482);var CompanyInfo=(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_1__.Z)((function CompanyInfo(attributes){var _attributes$isLink,_attributes$copyable,_attributes$onlyFull;(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_0__.Z)(this,CompanyInfo);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"icon",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"key",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"isLink",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"copyable",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"urlPrefix",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"urlType",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"title",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"titleOnly",void 0);(0,_mnt_c_Users_sofiane_Documents_IT_Projects_sphere_dashboard_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_2__.Z)(this,"onlyFull",void 0);this.icon=attributes.icon;this.key=attributes.key;this.isLink=(_attributes$isLink=attributes.isLink)!==null&&_attributes$isLink!==void 0?_attributes$isLink:false;this.urlPrefix=attributes.urlPrefix;this.urlType=attributes.urlType;this.title=attributes.title;this.titleOnly=attributes.titleOnly===true&&typeof attributes.title!=="undefined";this.copyable=(_attributes$copyable=attributes.copyable)!==null&&_attributes$copyable!==void 0?_attributes$copyable:false;this.onlyFull=(_attributes$onlyFull=attributes.onlyFull)!==null&&_attributes$onlyFull!==void 0?_attributes$onlyFull:false}))},95087:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:function(){return active_partner_card}});var runtime_core_esm_bundler=__webpack_require__(66252);var runtime_dom_esm_bundler=__webpack_require__(49963);var shared_esm_bundler=__webpack_require__(3577);var _withScopeId=function _withScopeId(n){return _pushScopeId("data-v-28c12d09"),n=n(),_popScopeId(),n};var _hoisted_1={class:"pl-0 mb-0"};var _hoisted_2=["onClick"];var _hoisted_3={class:"ml-2"};var _hoisted_4=(0,runtime_core_esm_bundler.Uk)("bloqué");function render(_ctx,_cache,$props,$setup,$data,$options){var _component_ssf_icon=(0,runtime_core_esm_bundler.up)("ssf-icon");var _component_card_company_info=(0,runtime_core_esm_bundler.up)("card-company-info");var _component_ssf_container=(0,runtime_core_esm_bundler.up)("ssf-container");var _component_ssf_text=(0,runtime_core_esm_bundler.up)("ssf-text");return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{class:"position-relative","not-full":""},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_card_company_info,{"full-data":_ctx.fullData,icon:_ctx.icon,item:_ctx.partner,"item-keys":_ctx.itemKeys,"data-type":"partner","with-action":""},{"action-content":(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("ul",_hoisted_1,[((0,runtime_core_esm_bundler.wg)(true),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,(0,runtime_core_esm_bundler.Ko)(_ctx.actions,(function(action,$idx){return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,[_ctx.fullData||!action.onlyFull?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("li",{key:0,class:"action-item p-2 cursor-pointer rounded",onClick:(0,runtime_dom_esm_bundler.iM)(action.method,["prevent"])},[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:action.icon,fw:"",light:""},null,8,["icon"]),(0,runtime_core_esm_bundler._)("span",_hoisted_3,(0,shared_esm_bundler.zw)(action.label),1)],8,_hoisted_2)):(0,runtime_core_esm_bundler.kq)("",true)],64)})),256))])]})),_:1},8,["full-data","icon","item","item-keys"]),!(_ctx.partner.available===true)?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{key:0,class:"blocked-banner full-absolute px-3 rounded"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"blocked-banner-bg bg-danger rounded"}),(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"blocked-banner-text full-flex full-absolute"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_text,{class:"text-white text-uppercase font-weight-bold"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[_hoisted_4]})),_:1})]})),_:1})]})),_:1})):(0,runtime_core_esm_bundler.kq)("",true)]})),_:1})}var vuex_esm_bundler=__webpack_require__(33907);var reactivity_esm_bundler=__webpack_require__(2262);var partner=__webpack_require__(15891);var swal=__webpack_require__(62045);var card_company_info=__webpack_require__(63298);var vue_router_esm_bundler=__webpack_require__(42119);var active_partner_cardvue_type_script_lang_ts=(0,runtime_core_esm_bundler.aZ)({name:"active-partner-card",components:{CardCompanyInfo:card_company_info.Z},props:{partner:{type:partner.Z,required:true},itemKeys:{type:Array,required:true},icon:{type:String,required:false},fullData:{type:Boolean,required:false,default:true}},emits:["destroyed","edit:partner"],setup:function setup(props,_ref){var emit=_ref.emit;var store=(0,vuex_esm_bundler.oR)();var router=(0,vue_router_esm_bundler.tv)();var destroy=function destroy(){return swal.JT.fire({html:"<span>Êtes-vous sûr(e) de vouloir supprimer ce fournisseur ? <br/><span class='small'>(Cette action est irréversible)</span></span>",confirmButtonText:"Oui, j'en suis sûr",showCancelButton:true,cancelButtonText:"J'hésite encore",allowOutsideClick:false,customClass:{cancelButton:"rounded py-3 bg-warning",confirmButton:"rounded py-3 bg-danger"}}).then((function(answer){return answer.isConfirmed&&answer.value?props.partner.destroy().then((function(){swal.mE.fire();return emit("destroyed",props.partner.id)})).catch((function(error){return swal.zk.fire({text:error.message})})):null}))};var forgotPassword=function forgotPassword(){return props.partner.forgotPassword(props.partner.email).then((function(){return(0,swal.Am)("Le lien a bien été envoyé à au fournisseur")}))};var openEditModal=function openEditModal(){return emit("edit:partner",props.partner)};var updateActions=function updateActions(){return actions.value=actionsList()};var toggleActive=function toggleActive(){return(props.partner.available===true?props.partner.block():props.partner.unblock()).then((function(){return updateActions()}))};var actionsList=function actionsList(){return[{method:openEditModal,label:"Modifier",icon:"pen",onlyFull:true},{method:destroy,label:"Supprimer",icon:"trash-can-list",onlyFull:true},{method:toggleActive,label:props.partner.available===true?"Bloquer":"Débloquer",icon:props.partner.available===true?"ban":"check-double",onlyFull:true},{method:forgotPassword,label:"Réinitialiser le mot de passe",icon:"lock-keyhole",onlyFull:true},{method:function method(){return router.push({name:"partners.by-number",params:{partnerNumber:props.partner.partnerNumber}})},label:"Afficher les détails",icon:"eye",onlyFull:false}]};var actions=(0,reactivity_esm_bundler.iH)(actionsList());return{actions:actions}}});var exportHelper=__webpack_require__(83744);const __exports__=(0,exportHelper.Z)(active_partner_cardvue_type_script_lang_ts,[["render",render],["__scopeId","data-v-28c12d09"]]);var active_partner_card=__exports__},53701:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:function(){return active_partners}});var runtime_core_esm_bundler=__webpack_require__(66252);var shared_esm_bundler=__webpack_require__(3577);var _withScopeId=function _withScopeId(n){return(0,runtime_core_esm_bundler.dD)("data-v-1d57f80c"),n=n(),(0,runtime_core_esm_bundler.Cn)(),n};var _hoisted_1=_withScopeId((function(){return(0,runtime_core_esm_bundler._)("span",{class:"secondary-item"}," Aucun fournisseur ",-1)}));var _hoisted_2={class:"p-3 bg-white border rounded"};var _hoisted_3=["onClick"];function render(_ctx,_cache,$props,$setup,$data,$options){var _component_active_partner_card=(0,runtime_core_esm_bundler.up)("active-partner-card");var _component_ssf_row=(0,runtime_core_esm_bundler.up)("ssf-row");var _component_ssf_col=(0,runtime_core_esm_bundler.up)("ssf-col");var _component_ssf_container=(0,runtime_core_esm_bundler.up)("ssf-container");var _component_modal_edit_partner=(0,runtime_core_esm_bundler.up)("modal-edit-partner");return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{class:"position-relative",name:"active-partners"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[_ctx.partners&&_ctx.partners.length>0?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{key:0,class:"active-partners-container"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_row,null,{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_col,{md:_ctx.byNumber?12:9,"no-padding":"",xs:"12"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_row,null,{default:(0,runtime_core_esm_bundler.w5)((function(){return[((0,runtime_core_esm_bundler.wg)(true),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,(0,runtime_core_esm_bundler.Ko)(_ctx.partners,(function(partner){return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_active_partner_card,{"full-data":_ctx.byNumber,icon:_ctx.Partner.icon.name,"item-keys":_ctx.itemKeys,partner:partner,onDestroyed:_ctx.onDestroyed,"onEdit:partner":_ctx.onEditPartnerOpen},null,8,["full-data","icon","item-keys","partner","onDestroyed","onEdit:partner"])})),256))]})),_:1})]})),_:1},8,["md"])]})),_:1})]})),_:1})):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{key:1,class:"full-absolute full-flex"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[_hoisted_1]})),_:1})),!_ctx.byNumber?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_col,{key:2,class:"position-fixed ml-auto activity-selector",md:"3","no-padding":""},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("ul",_hoisted_2,[((0,runtime_core_esm_bundler.wg)(true),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,(0,runtime_core_esm_bundler.Ko)(_ctx.allActivities,(function(activity){return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("li",{class:(0,shared_esm_bundler.C_)([{"bg-light":activity.id===_ctx.currentActivityId},"p-2 rounded cursor-pointer"]),onClick:function onClick($event){return _ctx.changeActivityId(activity.id)}},(0,shared_esm_bundler.zw)(activity.label),11,_hoisted_3)})),256))])]})),_:1})):(0,runtime_core_esm_bundler.kq)("",true),_ctx.modals.editPartner.open?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_modal_edit_partner,{key:3,activities:_ctx.activities,"modal-name":_ctx.modals.editPartner.name,open:_ctx.modals.editPartner.open,partner:_ctx.modals.editPartner.props.partner,onClose:_ctx.onEditPartnerClose,onCreated:_ctx.onCreated},null,8,["activities","modal-name","open","partner","onClose","onCreated"])):(0,runtime_core_esm_bundler.kq)("",true)]})),_:1})}var vuex_esm_bundler=__webpack_require__(33907);var reactivity_esm_bundler=__webpack_require__(2262);var partner=__webpack_require__(15891);var company_info=__webpack_require__(4502);var commons=__webpack_require__(18416);var card_company_info=__webpack_require__(63298);var active_partner_card=__webpack_require__(95087);var modal_edit_partner=__webpack_require__(48722);var activity_activity=__webpack_require__(16153);var vue_router_esm_bundler=__webpack_require__(42119);var active_partnersvue_type_script_lang_ts=(0,runtime_core_esm_bundler.aZ)({name:"active-partners",components:{ActivePartnerCard:active_partner_card["default"],CardCompanyInfo:card_company_info.Z,ModalEditPartner:modal_edit_partner["default"]},props:{byNumber:{type:Boolean,required:false,default:false}},setup:function setup(){var store=(0,vuex_esm_bundler.oR)();var route=(0,vue_router_esm_bundler.yj)();var fetchActive=function fetchActive(){return partnerNumber.value?store.dispatch("partner/fetchActiveByNumber",{partnerNumber:partnerNumber.value}):store.dispatch("partner/fetchActive",{activityId:currentActivityId.value})};var onDestroyed=function onDestroyed(){return fetchActive()};(0,runtime_core_esm_bundler.bv)((function(){fetchActive();if(activities.value===null){store.dispatch("activity/fetchAll")}}));var partners=(0,runtime_core_esm_bundler.Fl)((function(){return store.getters["partner/activePartners"]}));var activities=(0,runtime_core_esm_bundler.Fl)((function(){return store.getters["activity/activities"]}));var partnerNumber=(0,runtime_core_esm_bundler.Fl)((function(){var _route$params$partner;return route.params.partnerNumber&&((_route$params$partner=route.params.partnerNumber)===null||_route$params$partner===void 0?void 0:_route$params$partner.trim())!==""?route.params.partnerNumber:null}));var currentActivityId=(0,reactivity_esm_bundler.iH)(null);var activity=(0,reactivity_esm_bundler.iH)((new activity_activity.Z).__setItemAttributes({id:null,label:"Tous",name:"all"}));var modals=(0,reactivity_esm_bundler.qj)({editPartner:{open:false,name:"modal-edit-partner",props:{partner:null}}});(0,runtime_core_esm_bundler.YP)((function(){return currentActivityId.value}),(function(){return fetchActive()}));(0,runtime_core_esm_bundler.YP)((function(){return partnerNumber.value}),(function(){return fetchActive()}));return{modals:modals,currentActivityId:currentActivityId,activity:activity,partners:partners,activities:activities,onDestroyed:onDestroyed,Partner:partner.Z}},data:function data(){return{itemKeys:[new company_info.Z({icon:"at",key:"email",isLink:true,urlPrefix:commons.lu.email,urlType:commons.k2.email,copyable:true,onlyFull:true}),new company_info.Z({icon:"mobile",key:"phone",isLink:true,urlPrefix:commons.lu.phone,urlType:commons.k2.phone,copyable:true,onlyFull:false}),new company_info.Z({icon:"file-certificate",key:"certificate",isLink:true,title:"KBIS",urlPrefix:commons.lu.empty,urlType:commons.k2.image,titleOnly:true,onlyFull:false}),new company_info.Z({icon:"stamp",key:"siret",title:"Siret",onlyFull:false})]}},computed:{allActivities:function allActivities(){return this.activities&&this.activities.length?[this.activity].concat(this.activities):this.activities}},methods:{toggleModal:function toggleModal(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var modalName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"editPartner";this.modals[modalName].open=value},onEditPartnerOpen:function onEditPartnerOpen(partner){this.modals.editPartner.props.partner=partner;this.toggleModal()},onEditPartnerClose:function onEditPartnerClose(){this.toggleModal(false)},onCreated:function onCreated(){},changeActivityId:function changeActivityId(activityId){this.currentActivityId=activityId}}});var exportHelper=__webpack_require__(83744);const __exports__=(0,exportHelper.Z)(active_partnersvue_type_script_lang_ts,[["render",render],["__scopeId","data-v-1d57f80c"]]);var active_partners=__exports__}}]);