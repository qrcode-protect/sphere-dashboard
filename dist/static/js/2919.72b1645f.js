"use strict";(self["webpackChunksphere_dashboard"]=self["webpackChunksphere_dashboard"]||[]).push([[2919,697],{90697:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{create:function(){return create}});var _app_modules_user_user__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17961);var create=function create(data){var user=(new _app_modules_user_user__WEBPACK_IMPORTED_MODULE_0__.Z).setAttributes(data);return user.store(data)}},25371:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var sweetalert2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(86455);var sweetalert2__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(sweetalert2__WEBPACK_IMPORTED_MODULE_0__);var _config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(48836);var config={icon:"success",title:"Réussi",text:"L'action s'est terminée avec succès",customClass:{title:_config__WEBPACK_IMPORTED_MODULE_1__.Z.customClass.title,content:_config__WEBPACK_IMPORTED_MODULE_1__.Z.customClass.content,popup:_config__WEBPACK_IMPORTED_MODULE_1__.Z.customClass.popup,confirmButton:"".concat(_config__WEBPACK_IMPORTED_MODULE_1__.Z.customClass.confirmButton," success-color-dark")},confirmButtonText:"J'ai compris"};var MainSuccess=sweetalert2__WEBPACK_IMPORTED_MODULE_0___default().mixin(config);__webpack_exports__["Z"]=MainSuccess},82919:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:function(){return components}});var runtime_core_esm_bundler=__webpack_require__(66252);var shared_esm_bundler=__webpack_require__(3577);var _withScopeId=function _withScopeId(n){return _pushScopeId("data-v-24023500"),n=n(),_popScopeId(),n};var _hoisted_1=(0,runtime_core_esm_bundler.Uk)(" Ajouter un utilisateur ");var _hoisted_2={class:"table"};var _hoisted_3={key:0};function render(_ctx,_cache,$props,$setup,$data,$options){var _component_ssf_icon=(0,runtime_core_esm_bundler.up)("ssf-icon");var _component_ssf_container=(0,runtime_core_esm_bundler.up)("ssf-container");var _component_table_user_row=(0,runtime_core_esm_bundler.up)("table-user-row");var _component_vue_custom_scrollbar=(0,runtime_core_esm_bundler.up)("vue-custom-scrollbar");var _component_modal_create_user=(0,runtime_core_esm_bundler.up)("modal-create-user");return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{name:"users"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,null,{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_vue_custom_scrollbar,{options:{wheelPropagation:true,suppressScrollX:false},style:{"padding-bottom":"105px"}},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{name:"users-add-button",class:"text-right"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("button",{class:"btn pr-2",onClick:_cache[0]||(_cache[0]=function($event){return _ctx.modals.dataInformation.open=true})},[_hoisted_1,(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:"user-plus",light:"",size:"sm"})])]})),_:1}),(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{name:"users-table-container"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("table",_hoisted_2,[(0,runtime_core_esm_bundler._)("thead",null,[(0,runtime_core_esm_bundler._)("tr",null,[((0,runtime_core_esm_bundler.wg)(true),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,(0,runtime_core_esm_bundler.Ko)(_ctx.columnDefs,(function(column){return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("th",{class:(0,shared_esm_bundler.C_)({"text-center":column.center})},(0,shared_esm_bundler.zw)(column.label),3)})),256))])]),_ctx.users?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("tbody",_hoisted_3,[((0,runtime_core_esm_bundler.wg)(true),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,(0,runtime_core_esm_bundler.Ko)(_ctx.users,(function(user){return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_table_user_row,{roles:_ctx.roles,user:user,onDestroyed:_ctx.onCreated},null,8,["roles","user","onDestroyed"])})),256))])):(0,runtime_core_esm_bundler.kq)("",true)])]})),_:1})]})),_:1})]})),_:1}),_ctx.modals.dataInformation.open?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_modal_create_user,{key:0,files:_ctx.modals.dataInformation.props.files,"modal-name":_ctx.modals.dataInformation.name,open:_ctx.modals.dataInformation.open,onClose:_ctx.onDataInformationClose,onCreated:_ctx.onCreated},null,8,["files","modal-name","open","onClose","onCreated"])):(0,runtime_core_esm_bundler.kq)("",true)]})),_:1})}var es_array_includes=__webpack_require__(26699);var reactivity_esm_bundler=__webpack_require__(2262);var vue_meta_esm_browser_min=__webpack_require__(43612);var vuex_esm_bundler=__webpack_require__(33907);var commons=__webpack_require__(18416);var table_user_row=__webpack_require__(27638);var vue3_perfect_scrollbar_esm=__webpack_require__(39081);var lodash=__webpack_require__(96486);var role_type=__webpack_require__(9399);var modal_create_user=__webpack_require__(84213);var componentsvue_type_script_lang_ts=(0,runtime_core_esm_bundler.aZ)({name:"users-index",components:{ModalCreateUser:modal_create_user["default"],TableUserRow:table_user_row["default"],VueCustomScrollbar:vue3_perfect_scrollbar_esm.F},setup:function setup(){(0,vue_meta_esm_browser_min.jq)({title:"Utilisateurs"});var store=(0,vuex_esm_bundler.oR)();var modals=(0,reactivity_esm_bundler.qj)({dataInformation:{open:false,name:"modal-create-user",props:{files:null}}});(0,runtime_core_esm_bundler.bv)((function(){return fetchUsers()}));var users=(0,runtime_core_esm_bundler.Fl)((function(){return store.getters["user/users"]}));var roles=(0,runtime_core_esm_bundler.Fl)((function(){return(0,lodash.filter)((0,commons.uJ)(),(function(role){return[role_type.G.marketing,role_type.G.user,role_type.G.admin].includes(role.value)})).filter((function(role){return role.label=role.label.capitalize()}))}));var fetchUsers=function fetchUsers(){return store.dispatch("user/fetchDashboard")};var onCreated=function onCreated(){return fetchUsers()};var onDataInformationClose=function onDataInformationClose(){modals.dataInformation.open=false};return{modals:modals,users:users,roles:roles,onDataInformationClose:onDataInformationClose,onCreated:onCreated}},data:function data(){return{columnDefs:[{label:"#"},{label:"Rôle"},{label:"Nom"},{label:"Prénom"},{label:"Nom d'utilisateur"},{label:"Adresse e-mail"},{label:"Actions",center:true}]}}});var exportHelper=__webpack_require__(83744);const __exports__=(0,exportHelper.Z)(componentsvue_type_script_lang_ts,[["render",render],["__scopeId","data-v-24023500"]]);var components=__exports__},84213:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:function(){return modal_create_user}});var runtime_core_esm_bundler=__webpack_require__(66252);var runtime_dom_esm_bundler=__webpack_require__(49963);var _hoisted_1=(0,runtime_core_esm_bundler._)("hr",{class:"w-75 mt-4"},null,-1);var _hoisted_2=["innerHTML"];var _hoisted_3={class:"btn text-danger",type:"button"};var _hoisted_4={class:"btn text-success",type:"button"};function render(_ctx,_cache,$props,$setup,$data,$options){var _component_ssf_icon=(0,runtime_core_esm_bundler.up)("ssf-icon");var _component_ssf_container=(0,runtime_core_esm_bundler.up)("ssf-container");var _component_ssf_col=(0,runtime_core_esm_bundler.up)("ssf-col");var _component_ssf_row=(0,runtime_core_esm_bundler.up)("ssf-row");var _component_qrcp_input=(0,runtime_core_esm_bundler.up)("qrcp-input");var _component_ssf_modal=(0,runtime_core_esm_bundler.up)("ssf-modal");return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_modal,{modelValue:_ctx.open,"onUpdate:modelValue":_cache[5]||(_cache[5]=function($event){return _ctx.open=$event}),"click-to-close":false,"esc-to-close":false,name:_ctx.modalName,attach:"#app","body-classes":"pt-4 border-0",classes:"modal-container full-flex","content-class":"modal-content z-depth-1 full-flex modal-data-information rounded","fit-parent":"","footer-classes":"p-2 border-0 align-flex","header-classes":"pt-4 d-block border-0","lock-scroll":""},{header:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,null,{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"modal-header-icon full-flex mx-auto border-color-2 btn--corners","not-full":""},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("span",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:"user-plus",size:"1x5",thin:""})])]})),_:1})]})),_:1}),_hoisted_1]})),body:(0,runtime_core_esm_bundler.w5)((function(){return[_ctx.error?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_row,{key:0,class:"mb-3"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_col,{class:"form-fallback-container align-flex text-danger",size:"12"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{class:"mr-2",icon:"times-circle",light:"",size:"1x5"}),(0,runtime_core_esm_bundler._)("span",{innerHTML:_ctx.error},null,8,_hoisted_2)]})),_:1})]})),_:1})):(0,runtime_core_esm_bundler.kq)("",true),(0,runtime_core_esm_bundler._)("form",{style:{"padding-bottom":"75px"},onSubmit:_cache[4]||(_cache[4]=(0,runtime_dom_esm_bundler.iM)((function(){return _ctx.save&&_ctx.save.apply(_ctx,arguments)}),["prevent"]))},[(0,runtime_core_esm_bundler.Wm)(_component_qrcp_input,{errors:_ctx.errors,value:_ctx.user.lastname,icon:"user",label:"Nom de famille",name:"lastname",required:"",row:"","onUpdate:value":_cache[0]||(_cache[0]=function(event){return _ctx.user.lastname=event})},null,8,["errors","value"]),(0,runtime_core_esm_bundler.Wm)(_component_qrcp_input,{errors:_ctx.errors,value:_ctx.user.firstname,icon:"user-alt",label:"Prénom",name:"firstname",required:"",row:"","onUpdate:value":_cache[1]||(_cache[1]=function(event){return _ctx.user.firstname=event})},null,8,["errors","value"]),(0,runtime_core_esm_bundler.Wm)(_component_qrcp_input,{errors:_ctx.errors,value:_ctx.user.email,icon:"at",label:"Adresse e-mail",name:"email",required:"",row:"",onInput:_ctx.onEmailInput,"onUpdate:value":_cache[2]||(_cache[2]=function(event){return _ctx.user.email=event})},null,8,["errors","value","onInput"]),(0,runtime_core_esm_bundler.Wm)(_component_qrcp_input,{errors:_ctx.errors,"option-items":_ctx.roles,value:_ctx.user.roleType,name:"roleType","option-field":"name","option-label":"label",required:"",row:"",select:"","wheel-propagation":"","onUpdate:value":_cache[3]||(_cache[3]=function(event){return _ctx.user.roleType=event})},null,8,["errors","option-items","value"])],32)]})),footer:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_row,{class:"cursor-pointer"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_col,{class:"text-center",size:"6",onClick:_ctx.cancel},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("button",_hoisted_3,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:"ban",light:"",size:"2x"})])]})),_:1},8,["onClick"]),(0,runtime_core_esm_bundler.Wm)(_component_ssf_col,{class:"text-center",size:"6",onClick:_ctx.save},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("button",_hoisted_4,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:"floppy-disk-circle-arrow-right",light:"",size:"2x"})])]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["modelValue","name"])}var es_array_includes=__webpack_require__(26699);var reactivity_esm_bundler=__webpack_require__(2262);var lodash=__webpack_require__(96486);var commons=__webpack_require__(18416);var auth=__webpack_require__(74874);var utils=__webpack_require__(90697);var validation=__webpack_require__(81909);var qrcp_input=__webpack_require__(50918);var main_success=__webpack_require__(25371);var modal_create_uservue_type_script_lang_js=(0,runtime_core_esm_bundler.aZ)({name:"modal-create-user",components:{QrcpInput:qrcp_input.Z},props:{modalName:{type:String,required:false,default:"modal-create-user"},open:{type:Boolean,required:false,default:false}},emits:["close","save","created"],setup:function setup(props,_ref){var emit=_ref.emit;var ctx=(0,runtime_core_esm_bundler.FN)().ctx;var user=(0,reactivity_esm_bundler.iH)({lastname:null,firstname:null,email:null,roleType:null});var errors=(0,reactivity_esm_bundler.iH)([]);var error=(0,reactivity_esm_bundler.iH)(null);var success=(0,reactivity_esm_bundler.iH)(null);var loading=(0,reactivity_esm_bundler.iH)(false);var close=function close(){return emit("close")};var cancel=function cancel(){return close()};var validator=function validator(){if(validation.Gu.email(user.value.email)){var result=(0,validation.sC)(user.value);error.value=result.error;errors.value=result.errors;return result.valid}ctx.onEmailInput();error.value="Merci de vérifier le formulaire.";return false};var save=function save(){if(loading.value)return false;if(validator()){if((0,commons.VI)(user.value.firstname)&&(0,commons.VI)(user.value.lastname)&&(0,commons.VI)(user.value.email)){loading.value=true;error.value=null;(0,utils.create)({lastname:user.value.lastname,firstname:user.value.firstname,email:user.value.email,roleType:user.value.roleType}).then((function(){main_success.Z.fire({allowOutsideClick:false}).then((function(){close();emit("created")}))})).catch((function(e){var _e$message;return error.value=(_e$message=e===null||e===void 0?void 0:e.message)!==null&&_e$message!==void 0?_e$message:"Merci de réessayer plus tard"})).finally((function(){return loading.value=false}))}}};var roles=(0,runtime_core_esm_bundler.Fl)((function(){return(0,lodash.filter)((0,auth.uJ)(),(function(role){return role.label=role.label.capitalize()}))}));return{user:user,errors:errors,error:error,success:success,loading:loading,roles:roles,save:save,cancel:cancel}},methods:{onEmailInput:function onEmailInput(){this.onFieldInput("email")},onFieldInput:function onFieldInput(field){if(!validation.Gu[field](this.user[field])){if(!this.errors.includes("".concat(field,".format")))this.errors.push("".concat(field,".format"))}else this.errors=this.errors.filter((function(item){return item!=="".concat(field,".format")}))}}});var exportHelper=__webpack_require__(83744);const __exports__=(0,exportHelper.Z)(modal_create_uservue_type_script_lang_js,[["render",render]]);var modal_create_user=__exports__}}]);