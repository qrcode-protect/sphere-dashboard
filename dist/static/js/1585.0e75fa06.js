"use strict";(self["webpackChunksphere_dashboard"]=self["webpackChunksphere_dashboard"]||[]).push([[1585],{8836:function(__unused_webpack_module,__webpack_exports__){var config={customClass:{title:"open-sans",content:"open-sans",popup:"p-0 rounded",confirmButton:"btn-block rounded py-3"},confirmButtonText:"J'ai compris"};__webpack_exports__["Z"]=config},6494:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _config__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8836);var sweetalert2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6455);var sweetalert2__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(sweetalert2__WEBPACK_IMPORTED_MODULE_1__);var config={icon:"error",title:"Oups...",text:"Une erreur est survenue, merci de réessayer plus tard",customClass:{title:_config__WEBPACK_IMPORTED_MODULE_0__.Z.customClass.title,content:_config__WEBPACK_IMPORTED_MODULE_0__.Z.customClass.content,popup:_config__WEBPACK_IMPORTED_MODULE_0__.Z.customClass.popup,confirmButton:"".concat(_config__WEBPACK_IMPORTED_MODULE_0__.Z.customClass.confirmButton," danger-color-dark")},confirmButtonText:"J'ai compris"};var MainError=sweetalert2__WEBPACK_IMPORTED_MODULE_1___default().mixin(config);__webpack_exports__["Z"]=MainError},7638:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{default:function(){return table_user_row}});var runtime_core_esm_bundler=__webpack_require__(6252);var shared_esm_bundler=__webpack_require__(3577);var runtime_dom_esm_bundler=__webpack_require__(9963);var _hoisted_1={class:"user-item-row"};var _hoisted_2={key:0};var _hoisted_3={key:0};var _hoisted_4={key:0};var _hoisted_5={key:0};var _hoisted_6=["href"];var _hoisted_7={class:"pl-0 mb-0"};var _hoisted_8=["onClick"];var _hoisted_9={class:"text-center ml-2"};var _hoisted_10={key:1,class:"ml-2"};function render(_ctx,_cache,$props,$setup,$data,$options){var _component_ssf_initial=(0,runtime_core_esm_bundler.up)("ssf-initial");var _component_ssf_icon=(0,runtime_core_esm_bundler.up)("ssf-icon");var _component_ssf_container=(0,runtime_core_esm_bundler.up)("ssf-container");var _component_ssf_form_group=(0,runtime_core_esm_bundler.up)("ssf-form-group");var _component_ssf_dropdown=(0,runtime_core_esm_bundler.up)("ssf-dropdown");return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("tr",_hoisted_1,[(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"cell-item full-flex font-weight-bold","not-full":""},{default:(0,runtime_core_esm_bundler.w5)((function(){return[_ctx.editMode===false?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_initial,{key:0,content:_ctx.initials,class:"user-initials rounded-circle full-flex","not-full":""},null,8,["content"])):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_icon,{key:1,icon:"save",light:"",size:"1x5",onClick:_ctx.save},null,8,["onClick"]))]})),_:1})]),(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:(0,shared_esm_bundler.C_)([{"edit-mode":_ctx.editMode},"align-flex cell-item"])},{default:(0,runtime_core_esm_bundler.w5)((function(){return[_ctx.editMode===false?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("span",_hoisted_2,(0,shared_esm_bundler.zw)(_ctx.roleLabel(_ctx.user.roleType).capitalize()),1)):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_form_group,{key:1,name:"user-role-".concat(_ctx.user.id),"option-items":_ctx.roles,value:_ctx.updatable.roleType,"option-field":"value","option-label":"label",row:"",select:"","onUpdate:value":_cache[0]||(_cache[0]=function(event){return _ctx.updatable.roleType=event})},null,8,["name","option-items","value"]))]})),_:1},8,["class"])]),(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:(0,shared_esm_bundler.C_)([{"edit-mode":_ctx.editMode},"align-flex cell-item"])},{default:(0,runtime_core_esm_bundler.w5)((function(){var _ctx$user$lastname;return[_ctx.editMode===false?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("span",_hoisted_3,(0,shared_esm_bundler.zw)((_ctx$user$lastname=_ctx.user.lastname)===null||_ctx$user$lastname===void 0?void 0:_ctx$user$lastname.capitalize()),1)):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_form_group,{key:1,name:"user-lastname-".concat(_ctx.user.id),value:_ctx.updatable.lastname,row:"","onUpdate:value":_cache[1]||(_cache[1]=function(event){return _ctx.updatable.lastname=event})},null,8,["name","value"]))]})),_:1},8,["class"])]),(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:(0,shared_esm_bundler.C_)([{"edit-mode":_ctx.editMode},"align-flex cell-item"])},{default:(0,runtime_core_esm_bundler.w5)((function(){var _ctx$user$firstname;return[_ctx.editMode===false?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("span",_hoisted_4,(0,shared_esm_bundler.zw)((_ctx$user$firstname=_ctx.user.firstname)===null||_ctx$user$firstname===void 0?void 0:_ctx$user$firstname.capitalize()),1)):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_form_group,{key:1,name:"user-firstname-".concat(_ctx.user.id),value:_ctx.updatable.firstname,"onUpdate:value":_cache[2]||(_cache[2]=function(event){return _ctx.updatable.firstname=event})},null,8,["name","value"]))]})),_:1},8,["class"])]),(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"align-flex cell-item"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Uk)((0,shared_esm_bundler.zw)(_ctx.user.username),1)]})),_:1})]),(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"align-flex cell-item"},{default:(0,runtime_core_esm_bundler.w5)((function(){var _ctx$user$email;return[_ctx.editMode===false?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("span",_hoisted_5,[(0,runtime_core_esm_bundler._)("a",{href:"mailto:".concat(_ctx.user.email)},(0,shared_esm_bundler.zw)((_ctx$user$email=_ctx.user.email)===null||_ctx$user$email===void 0?void 0:_ctx$user$email.toLowerCase()),9,_hoisted_6)])):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_form_group,{key:1,name:"user-email-".concat(_ctx.user.id),value:_ctx.updatable.email,"onUpdate:value":_cache[3]||(_cache[3]=function(event){return _ctx.updatable.email=event})},null,8,["name","value"]))]})),_:1})]),(0,runtime_core_esm_bundler._)("td",null,[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:"full-flex cell-item"},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_dropdown,{"allow-click-outside":false,"show-content":_ctx.showDropdownContent,"body-class":"text-center cursor-pointer"},{"dropdown-button":(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:"gear",thin:""})]})),"dropdown-content":(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("ul",_hoisted_7,[((0,runtime_core_esm_bundler.wg)(true),(0,runtime_core_esm_bundler.iD)(runtime_core_esm_bundler.HY,null,(0,runtime_core_esm_bundler.Ko)(_ctx.actions,(function(action,$idx){return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("li",{class:"ssf-dropdown-item px-2 cursor-pointer",onClick:(0,runtime_dom_esm_bundler.iM)(action.method,["prevent"])},[(0,runtime_core_esm_bundler.Wm)(_component_ssf_icon,{icon:action.icon,fw:"",light:""},null,8,["icon"]),action.children?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_dropdown,{key:0,class:"d-inline-block"},{"dropdown-button":(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler._)("span",_hoisted_9,(0,shared_esm_bundler.zw)(action.label),1)]})),"dropdown-content":(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_form_group,{name:"user-role-".concat(_ctx.user.id),"option-items":_ctx.roles,"option-field":"value","option-label":"label",select:""},null,8,["name","option-items"])]})),_:2},1024)):((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.iD)("span",_hoisted_10,(0,shared_esm_bundler.zw)(action.label),1))],8,_hoisted_8)})),256))])]})),_:1},8,["show-content"])]})),_:1})])])}var asyncToGenerator=__webpack_require__(8534);var toConsumableArray=__webpack_require__(9584);var regenerator=__webpack_require__(9298);var regenerator_default=__webpack_require__.n(regenerator);var reactivity_esm_bundler=__webpack_require__(2262);var user=__webpack_require__(7961);var role_type=__webpack_require__(9399);function ssf_dropdownvue_type_template_id_ec3df5f2_ts_true_render(_ctx,_cache,$props,$setup,$data,$options){var _component_ssf_container=(0,runtime_core_esm_bundler.up)("ssf-container");return(0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{class:"position-relative",name:"own-dropdown","not-full":""},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.Wm)(_component_ssf_container,{class:(0,shared_esm_bundler.C_)(_ctx.bodyClass),name:"own-dropdown-button","not-full":"",onClick:_ctx.toggleVisible},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.WI)(_ctx.$slots,"dropdown-button")]})),_:3},8,["class","onClick"]),_ctx.visible?((0,runtime_core_esm_bundler.wg)(),(0,runtime_core_esm_bundler.j4)(_component_ssf_container,{key:0,class:(0,shared_esm_bundler.C_)(["".concat(_ctx.visible?"show":""," ").concat(_ctx.contentClass),"position-absolute"]),name:"own-dropdown-content","not-full":""},{default:(0,runtime_core_esm_bundler.w5)((function(){return[(0,runtime_core_esm_bundler.WI)(_ctx.$slots,"dropdown-content")]})),_:3},8,["class"])):(0,runtime_core_esm_bundler.kq)("",true)]})),_:3})}var ssf_dropdownvue_type_script_lang_ts=(0,runtime_core_esm_bundler.aZ)({name:"ssf-dropdown",props:{contentClass:{type:String,required:false},bodyClass:{type:String,required:false},allowClickOutside:{type:Boolean,required:false,default:false},showContent:{type:Boolean,required:false,default:false}},setup:function setup(props){var visible=(0,reactivity_esm_bundler.iH)(false);var toggled=(0,reactivity_esm_bundler.iH)(false);var onClickOutside=function onClickOutside(event){if(toggled.value===false){if(props.allowClickOutside&&visible.value===true){visible.value=false}}};(0,runtime_core_esm_bundler.bv)((function(){window.addEventListener("click",onClickOutside)}));(0,runtime_core_esm_bundler.Jd)((function(){window.removeEventListener("click",onClickOutside)}));(0,runtime_core_esm_bundler.YP)((function(){return props.showContent}),(function(){return visible.value=props.showContent}),{immediate:true});return{visible:visible,toggled:toggled}},methods:{toggleVisible:function toggleVisible(){var _this=this;this.toggled=true;this.visible=!this.visible;setTimeout((function(){return _this.toggled=false}),500)}}});var exportHelper=__webpack_require__(3744);const __exports__=(0,exportHelper.Z)(ssf_dropdownvue_type_script_lang_ts,[["render",ssf_dropdownvue_type_template_id_ec3df5f2_ts_true_render]]);var ssf_dropdown=__exports__;var main_error=__webpack_require__(6494);var genRanHex=function genRanHex(){var size=arguments.length>0&&arguments[0]!==undefined?arguments[0]:6;return(0,toConsumableArray.Z)(Array(size)).map((function(){return Math.floor(Math.random()*16).toString(16)})).join("")};var table_user_rowvue_type_script_lang_ts=(0,runtime_core_esm_bundler.aZ)({name:"table-user-row",components:{SsfDropdown:ssf_dropdown},props:{user:{type:user.Z,required:true},roles:{type:Array,required:true}},emits:["destroyed"],setup:function setup(props,_ref){var emit=_ref.emit;var initials=(0,runtime_core_esm_bundler.Fl)((function(){return(props.user.lastname&&props.user.firstname?"".concat(props.user.lastname[0]).concat(props.user.firstname[0]):"nd").toUpperCase()}));var closeDropdownContent=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){return regenerator_default().wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:showDropdownContent.value=true;_context.next=3;return setTimeout((function(){return showDropdownContent.value=false}),100);case 3:updateActions();case 4:case"end":return _context.stop()}}}),_callee)})));return function closeDropdownContent(){return _ref2.apply(this,arguments)}}();var toggleActive=function toggleActive(){return(props.user.active?props.user.disable():props.user.enable()).then((function(){closeDropdownContent();return props.user.active=!props.user.active}))};var forgotPassword=function forgotPassword(){return props.user.forgotPassword(props.user.email).then((function(){return closeDropdownContent()}))};var destroy=function destroy(){return props.user.destroy().then((function(){closeDropdownContent();return emit("destroyed",props.user.id)}))};var toggleEditMode=function toggleEditMode(){var show=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;closeDropdownContent();return editMode.value=!editMode.value};var save=function save(){return props.user.update(props.user.id,updatable).then((function(){props.user.roleType=updatable.roleType;props.user.firstname=updatable.firstname;props.user.lastname=updatable.lastname;props.user.email=updatable.email;editMode.value=false;updateActions()})).catch((function(e){var _ref3,_ref4,_e$message,_e$response;return main_error.Z.fire({text:(_ref3=(_ref4=(_e$message=e===null||e===void 0?void 0:e.message)!==null&&_e$message!==void 0?_e$message:e===null||e===void 0?void 0:e.error)!==null&&_ref4!==void 0?_ref4:(_e$response=e.response)===null||_e$response===void 0?void 0:_e$response.message)!==null&&_ref3!==void 0?_ref3:"Merci de réessayer plus tard"})}))};var updateActions=function updateActions(){return actions.value=actionsList()};var actionsList=function actionsList(){return[{method:toggleActive,label:props.user.active?"Désactiver":"Activer",icon:props.user.active?"toggle-on":"toggle-off"},{method:destroy,label:"Supprimer",icon:"trash-can-list"},{method:toggleEditMode,label:editMode.value?"Annuler les modifications":"Modifier",icon:"user-pen"},{method:forgotPassword,label:"Réinitialiser le mot de passe",icon:"lock-keyhole"}]};var showDropdownContent=(0,reactivity_esm_bundler.iH)(false);var editMode=(0,reactivity_esm_bundler.iH)(false);var updatable=(0,reactivity_esm_bundler.qj)({roleType:props.user.roleType,firstname:props.user.firstname,lastname:props.user.lastname,email:props.user.email});var actions=(0,reactivity_esm_bundler.iH)(actionsList());return{actions:actions,showDropdownContent:showDropdownContent,editMode:editMode,updatable:updatable,initials:initials,genRanHex:genRanHex,toggleActive:toggleActive,roleLabel:role_type.c,save:save}}});const table_user_row_exports_=(0,exportHelper.Z)(table_user_rowvue_type_script_lang_ts,[["render",render]]);var table_user_row=table_user_row_exports_}}]);